import{jsx as r}from"react/jsx-runtime";import e from"@darkroom.engineering/tempus";import t from"lenis";import{useState as n,useEffect as s,createContext as i,forwardRef as o,useRef as l,useCallback as c,useImperativeHandle as a,useContext as u}from"react";"function"==typeof SuppressedError&&SuppressedError;const f=i(null),p=new class Store{constructor(r){this.listeners=[],this.state=r}set(r){this.state=r;for(let r of this.listeners)r(this.state)}subscribe(r){return this.listeners=[...this.listeners,r],()=>{this.listeners=this.listeners.filter((e=>e!==r))}}get(){return this.state}}({});function useCurrentLenis(){const r=u(f),e=function useStore(r){const[e,t]=n(r.get());return s((()=>r.subscribe((r=>t(r)))),[r]),e}(p);return null!=r?r:e}function useLenis(r,e=[],t=0){const{lenis:n,addCallback:i,removeCallback:o}=useCurrentLenis();return s((()=>{if(r&&i&&o&&n)return i(r,t),r(n),()=>{o(r)}}),[n,i,o,t,...e]),n}const d=o(((i,o)=>{var{children:u,root:d=!1,options:b={},autoRaf:m=!0,rafPriority:h=0,className:y}=i,v=function __rest(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(null!=r&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(n=Object.getOwnPropertySymbols(r);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(r,n[s])&&(t[n[s]]=r[n[s]])}return t}(i,["children","root","options","autoRaf","rafPriority","className"]);const O=l(null),g=l(null),[k,j]=n(void 0),C=l([]),w=c(((r,e)=>{C.current.push({callback:r,priority:e}),C.current.sort(((r,e)=>r.priority-e.priority))}),[]),S=c((r=>{C.current=C.current.filter((e=>e.callback!==r))}),[]);a(o,(()=>({wrapper:O.current,content:g.current,lenis:k})),[k]),s((()=>{const r=new t(Object.assign(Object.assign({},b),!d&&{wrapper:O.current,content:g.current}));return j(r),()=>{r.destroy(),j(void 0)}}),[d,JSON.stringify(b)]),s((()=>{if(k&&m)return e.add((r=>{null==k||k.raf(r)}),h)}),[k,m,h]),s((()=>{if(d&&k)return p.set({lenis:k,addCallback:w,removeCallback:S}),()=>p.set({})}),[d,k,w,S]);const P=c(((...r)=>{for(let e=0;e<C.current.length;e++)C.current[e].callback(...r)}),[]);return s((()=>(null==k||k.on("scroll",P),()=>{null==k||k.off("scroll",P)})),[k,P]),r(f.Provider,{value:{lenis:k,addCallback:w,removeCallback:S},children:d?u:r("div",Object.assign({ref:O,className:y},v,{children:r("div",{ref:g,children:u})}))})}));export{d as Lenis,f as LenisContext,d as ReactLenis,d as default,useLenis};
//# sourceMappingURL=lenis-react.mjs.map
